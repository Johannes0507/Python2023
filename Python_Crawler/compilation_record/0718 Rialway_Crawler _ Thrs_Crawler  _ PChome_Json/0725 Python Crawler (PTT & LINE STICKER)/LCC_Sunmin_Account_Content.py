# -*- coding: utf-8 -*-
"""
Created on Sat Jul 22 14:39:14 2023

@author: opjoh
"""

import requests
from bs4 import BeautifulSoup

# LCC登入連結
url = "https://member.lccnet.com.tw/"

# 模擬瀏覽器
header = {
'User-Agent':
'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/114.0.0.0 Safari/537.36',
'Cookie':
'_ga=GA1.4.1839824082.1685156996; adgeek_lccnet_user_id=48-1120105004; _gcl_au=1.1.1665313949.1688496458; _fbp=fb.2.1688496458543.1354467902; _cuid=f2ede838-e66a-4c77-9dbb-f6b873953fc8; _cuserid=; _cusertrait=%7B%7D; _ctrait=%7B%7D; _cgrpid=; _cgrptrait=%7B%7D; pid=https://www.lccnet.com.tw/lccnet/single-class/Python; _ss_pp_id=7d2a36a2f58b40eeb0e1688467659490; _hjSessionUser_1446807=eyJpZCI6ImZhYjA2YjliLTA1M2YtNWRlNS04OWM4LTFiNWFkMGI4MGRkZSIsImNyZWF0ZWQiOjE2ODg0OTY0NTkxMzIsImV4aXN0aW5nIjp0cnVlfQ==; _uetvid=401504b01a9b11eea8a84d84f112fa35; _td=02a13587-7ed5-4aee-9034-04e0388ccf78; _ga_QY8DQDPMSR=GS1.1.1688496458.1.1.1688496534.45.0.0; _ga_TDP4KNDS80=GS1.1.1688496458.1.1.1688496534.49.0.0; __RequestVerificationToken=kBqUzwkxMx7u1t2suBKwuE8V3aZItWKBaEbwWKvf97D9a3sSVYPsG6opvAyv59uhfc3cl9jS8qlzkQR9wzDEfiTMJrDiavuT40YWoFBdKds1; _ga=GA1.1.1839824082.1685156996; _gid=GA1.4.208377409.1690007995; ASP.NET_SessionId=ohzyxvfe43gj2uhp32hae2ph; .ASPXAUTH=BDBC8FDF10DB24160B56C84AC91CBBF7F6B09C246573FBF8C6525DBB7EFEA95C918120E5C22DC22112AD0604D27E97D31D23510FCE4DF1B86C127FED8333425E31FE1CDB8961272B775C7957994E3A8E9E557621FFBCCBB635D72A146EB4667A1428BAB73A161806F7CF6543D3871CCDA1BDC2C6DB9692AE3A61EC8365C9FD5E39C9DBA30FB1C21FCD0564BDA49DBBCBD73200A688FA884AF7EA4652A86106FA971B28B21DD280403A9D67CE7C07362A778D341435774537641A900343DE889A52036CBF30996792747F6ACC9294DEE356EFE0169250FCFD01E51408F2CB6D95BFF85D734C544C2E9364B9AD973C0949CF63EB1788E2E159533A272BEA64BAD66B05FB81D58229ACBD6F72D996389E276EAF1B9F3D16D1EB7D11B8883E71B68188F177C2DA51BE35D2D91F5BF503D77A3DDE82A22CCBD5C1066C9DEC7429872E2C55D95C1175F3A6D460DB8A7C344FF9C1015F3CD6A2807E10E375B516492DBDDB2D099B9B59860221C424C9B4357ACCF98F8B4BFA284B024D1AFCFEE79E82AD64AC5A46C70550039693ED0D90C168B70EB695251786D78DDB5FAAC1E363CE0705D4E2A7A45F7D8212CDC8CB41DF1AEA89D71C3AE8A6EA3CE5120ED15D45CCACD1510B3142690DAD1292A47CCE6902B4EB9902680EFE8CA935A40B1C171505913E22C5F762731F15627AD406C749DA83CB57C6986C4913ECEF5ECB4E816E11638F023BFE915452D2D60E900D632B41768F93A48F97F94FED7738562C663068E4DC48ED6B9B27D6844388CC726A01144D19982C75A9CBF955880356E035C9414821C00D44770AA1FB42AC6ECDC571C0EDAADC0D49042B9FE97787EA95AC6A9C1CE05572407B24317788F9E9D1FA26D31A9336A4209DA14ABE6849E4A5946028C6E075B9558C440CE1D760F9DD4626A44615F9F9184FC8756FE976A990F3B075678FBCD9B0FA7CB00F552B6D4C9F637EE84D8690D69341BA59BD37955AA5D5D21FC0B053197624C55BB7418F8D32893050B3E71432B6C8E1C4E588408E971C194FAE226C245F3B7F921630642C25B64F60F34110F1181963235366E1A6CDA0F08CA61F17AA1FBACB85B8FC36DC2159F17C8A0125417CA48AFAC565D83E12496CCA030A0B0E89472F660C90807E1C6BE6037F501AD552086E2E10B0899B2523F4EB9FE4DE6AF64F31DCCE0F3B4FC33462A7ECA1A0738F9A698E0CD4D589489632958D779CC348B2992F404C4AA46AC82410AA67E092A56B9B5D78A0A4FDEE1C1A6BD1286FDC7A3BA4F47D326A38F6D2F81C78A4062407B426058F6E8D417B4E7A0E57F761B5D3060F3E3C72D97EB6FD16390A57E7DB546018F8BA4DCB5420A6FF285D64FBF445B6A17464D7FAA7A47214A52CB00F604E5750D54C4C1548AD37E72ECBB966678642E2A1F15DC0A2B9043887A0D9390EACED74D1C5656244499DCADA8CFF6731B48F5997CF6E868D81B22CF6D9A59E78C155F431013ACE258B2D61C613A3C318E46DC2672C6D2411497AF81D945AA0780667202B2B8BDC7E9969E7390DC0ED9B905F9AFE2E6173D7AABF4220B6EEB800715498EB528296D4BAB5BC7DF6843BF9199826F35BE6ECB401E298EA749E0F5ABBBE519E0843F69B4DDD01D4E242FDF4F30C9BEAB40F71353D3418B4D272885FBAA057D18878F3A18AF748CC84559D8D322B9969777A25650DB6CF9BBE0DD16D8B3E6ED485ED1A91640D9B790F4DA8C19C4F40413C75CCBB048B510760255B6928B1F9C0165FD46C3EDFA6EE6AD31CB01B8023E2297D4908A44541E416EC102C2F6BFE351AA2F82E2BE8F24A3296A0227B37FCC8EE8F1D9BFD78A7F253282D4A02B444E30C9C068F3278A6773991FDF3356A17BF02F8629F5CB406E9BF8F2408EA7BB08E9D3F0128BB099FD7D14A630097B66FF7E0882F66F3FF1EDF4A6AC76B1709C9119F2906F638B0A1E8C35F70CFFE887A4724FF8AE40660BD69FB7F98CEC65E435C8ED10C03EC489A1D841CD5F16FD1A19B1A597A5BF9C8432E; _ga_RV6BDWB9GV=GS1.1.1690007994.7.1.1690008161.0.0.0'
    }

# 寫入參數，帳號(Account)、密碼(Password)裡的value需更改成自己的
param = {
'Account': '105664962',
'Password': 'N125744452',
'RememberMe': 'false',
'__RequestVerificationToken': 'E1lFVc3dwePrhBnKHU2g8xSqvWpCy7Zew19pNXlDkR9eKRu5dvI3yAO1ktTx-2jhgSdrEdwfjip-BSmZK8RbOAXIHMmipgVhHHRv0SMmb_41'
    }

# 使用session讓登入狀態持續
session_requests = requests.session()

# 指定的 URL 發送 HTTP POST 請求並獲取伺服器的回應內容，登入到學生頁面。
LCC = session_requests.post(url, headers=header, data=param)

# 進到聯成電腦使用者介面裡面的 "登記課程" -> "我的課程"
url2 = "https://member.lccnet.com.tw/Booking"

# 發送 HTTP POST 請求Booking內容
Booking = session_requests.post(url2).text

# 解析HTML
Booking_Content = BeautifulSoup(Booking, "html.parser")

# 找尋頁面內容(實體/線上 最新課程列表)
Course = Booking_Content.find('ul', class_='courseListWrapper')
Courses = Course.find_all("li")


print('實體/線上 最新課程列表')
for item in Courses:
    # 找出HTML相對應的標籤，並且展示內容。
    Title = item.find('div', class_='courseListLeft')
    Title_Content = Title.find('h4')
    Teacher = item.find('div', class_='courseListRoom')
    Date = Title.find('p')
    Link = 'https://member.lccnet.com.tw/' + Title.find('a').get('href')
    Img = item.find('img').get('src')
    
    print('Title:', Title_Content.text)
    print('Teacher:', Teacher.text)
    print('Date:', Date.text)
    print('Link:', Link)
    print('Photo_Link:', Img)
    print()
    













